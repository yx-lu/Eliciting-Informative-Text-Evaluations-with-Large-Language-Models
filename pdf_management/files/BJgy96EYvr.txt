Title:
```
Published as a conference paper at ICLR 2020 INFLUENCE-BASED MULTI-AGENT EXPLORATION
```
Abstract:
```
Intrinsically motivated reinforcement learning aims to address the exploration challenge for sparse-reward tasks. However, the study of exploration methods in transition-dependent multi-agent settings is largely absent from the literature. We aim to take a step towards solving this problem. We present two exploration methods: exploration via information-theoretic influence (EITI) and exploration via decision-theoretic influence (EDTI), by exploiting the role of interaction in coordinated behaviors of agents. EITI uses mutual information to capture the interdependence between the transition dynamics of agents. EDTI uses a novel intrinsic reward, called Value of Interaction (VoI), to characterize and quantify the influence of one agent's behavior on expected returns of other agents. By optimiz- ing EITI or EDTI objective as a regularizer, agents are encouraged to coordinate their exploration and learn policies to optimize the team performance. We show how to optimize these regularizers so that they can be easily integrated with pol- icy gradient reinforcement learning. The resulting update rule draws a connection between coordinated exploration and intrinsic reward distribution. Finally, we empirically demonstrate the significant strength of our methods in a variety of multi-agent scenarios.
```

Figures/Tables Captions:
```
Figure 1: Didactic examples. Left: task Pass. Two agents starting at the upper-left corner are only rewarded when both of them reach the other room through the door, which will open only when at least one of the switches is occupied by one or more agents. Middle: Secret-Room. An extension of Pass with 4 rooms and switches. When the switch 1 is occupied, all the three doors turn open. And the three switches on the right only control the door of its room. The agents need to reach the upper right room to achieve any reward. Right: comparison of our methods with ablations on Pass.
Figure 2: Development of performance of our methods compared to baselines and intrinsic reward terms of EITI, EDTI, and plusV over the training period of 9000 PPO updates segmented into three phases. "Team Reward" shows averaged team reward gained in a episode, with a maximum of 1000. It shows that only EITI, EDTI, and centralized control and Multi can learn the strategy during this stage. "EITI reward", "EDTI reward", and "plusV reward" demonstrate the evolving of correspond- ing intrinsic rewards.
Figure 3: Left: performance comparison between EDTI and EITI on Secret-Room over 7400 PPO updates. Right: EITI and EDTI terms of two agents after 100, 2900, and 7400 updates.
Figure 4: Comparison of our methods against ablations for Push-Box, Island, and Large-Island. Comparison with baselines is shown in Fig. 8 in Appendix D.
Table 1: Baseline algorithms. The third column is the reward used to train the value func- tion of PPO. u i and u cen are curiosity about individual state s i and global state s, T 1 = log (p(s -i |s, a)/p(s -i |s -i , a -i )), T 2 = 1 − p(s -i |s -i , a -i )/p(s -i |s, a), and ∆Q -i (s, a) = Q -i (s, a) − Q -i (s -i , a -i ). Social influence (Jaques et al., 2018) and COMA (Foerster et al., 2018) are augmented with curiosity.
```

Main Content:
```

Section Title: INTRODUCTION
  INTRODUCTION Reinforcement learning algorithms aim to learn a policy that maximizes the accumulative reward from an environment. Many advances of deep reinforcement learning rely on a dense shaped reward function, such as distance to the goal ( Mirowski et al., 2016 ;  Wu et al., 2018 ), scores in games ( Mnih et al., 2015 ) or expert-designed rewards ( Wu & Tian, 2016 ;  OpenAI, 2018 ), but they tend to strug- gle in many real-world scenarios with sparse rewards ( Burda et al., 2019 ). Therefore, many recent works propose to introduce additional intrinsic incentives to boost exploration, including pseudo- counts ( Bellemare et al., 2016 ;  Tang et al., 2017 ;  Ostrovski et al., 2017 ), model-learning improve- ments ( Burda et al., 2019 ;  Pathak et al., 2017 ;  Burda et al., 2018 ), and information gain ( Florensa et al., 2017 ;  Gupta et al., 2018 ;  Hyoungseok Kim, 2019 ). These works result in significant progress in many challenging tasks such as Montezuma Revenge ( Burda et al., 2018 ), robotic manipula- tion ( Pathak et al., 2018 ;  Riedmiller et al., 2018 ), and Super Mario games ( Burda et al., 2019 ;  Pathak et al., 2017 ). Notably, most of the existing breakthroughs on sparse-reward environments have been focusing on single-agent scenarios and leave the exploration problem largely unstudied for multi-agent settings - it is common in real-world applications that multiple agents are required to solve a task in a coordi- nated fashion ( Cao et al., 2012 ;  Nowé et al., 2012 ;  Zhang & Lesser, 2011 ). This problem has recently attracted attention and several exploration strategies have been proposed for transition-independent cooperative multi-agent settings ( Dimakopoulou & Van Roy, 2018 ;  Dimakopoulou et al., 2018 ;  Bar- giacchi et al., 2018 ;  Iqbal & Sha, 2019b ). Nevertheless, how to explore effectively in more general scenarios with complex reward and transition dependency among cooperative agents remains an open research problem.

Section Title: Published as a conference paper at ICLR 2020
  Published as a conference paper at ICLR 2020 This paper aims to take a step towards this goal. Our basic idea is to coordinate agents' exploration by taking into account their interactions during their learning processes. Configurations where in- teraction happens (interaction points) lie at critical junctions in the state-action space, through these critical configurations can transit to potentially important under-explored regions. To exploit this idea, we propose exploration strategies where agents start with decentralized exploration driven by their individual curiosity, and are also encouraged to visit interaction points to influence the ex- ploration processes of other agents and help them get more extrinsic and intrinsic rewards. Based on how to quantify influence among agents, we propose two exploration methods. Exploration via information-theoretic influence (EITI) uses mutual information (MI) to capture the interdependence between the transition dynamics of agents. Exploration via decision-theoretic influence (EDTI) goes further and uses a novel measure called value of interaction (VoI) to disentangle the effect of one agent's state-action pair on the expected (intrinsic) value of other agents. By optimizing MI or VoI as a regularizer to the value function, agents are encouraged to explore state-action pairs where they can exert influences on other agents for learning sophisticated multi-agent cooperation strategies. To efficiently optimize MI and VoI, we propose augmented policy gradient formulations so that the gradients can be estimated purely from trajectories. The resulting update rule draws a connection between coordinated exploration and the distribution of individual intrinsic rewards among team members, which further explains why our methods are able to facilitate multi-agent exploration. We demonstrate the effectiveness of our methods on a variety of sparse-reward cooperative multi- agent tasks. Empirical results show that both EITI and EDTI allow for the discovery of influential states and EDTI further filter out interactions that have no effects on the performance. Our results also imply that these influential states are implicitly discovered as subgoals in search space that guide and coordinate exploration. The video of experiments is available at https://sites. google.com/view/influence-based-mae/.

Section Title: SETTINGS
  SETTINGS In our work, we consider a fully cooperative multi-agent task that can be modelled by a factored multi-agent MDP G = N, S, A, T, r, h, n , where N ≡ {1, 2, ..., n} is the finite set of agents, S ≡ × i∈N S i is the finite set of joint states and S i is the state set of agent i. At each timestep, each agent selects an action a i ∈ A i at state s, forming a joint action a ∈ A ≡ × i∈N A i , resulting in a shared extrinsic reward r(s, a) for each agent and the next state s according to the transition function T (s |s, a). The objective of the task is that each agent learns a policy π i (a i |s i ), jointly maximizing team performance. The joint policy π= π 1 , . . . , π n induces an action-value function, Q ext,π (s, a)= E τ [ h t=0 r t |s 0 =s, a 0 =a, π], and a value function V ext,π (s)= max a Q ext,π (s, a), where τ is the episode trajectory and h is the horizon. We adopt a centralized training and decentralized execution paradigm, which has been widely used in multi-agent deep reinforcement learning ( Foerster et al., 2016 ;  Lowe et al., 2017 ;  Foerster et al., 2018 ;  Rashid et al., 2018 ). During training, agents are granted access to the states, actions, (intrinsic) rewards, and value functions of other agents, while decentralized execution only requires individual states.

Section Title: INFLUENCE-BASED COORDINATED MULTI-AGENT EXPLORATION
  INFLUENCE-BASED COORDINATED MULTI-AGENT EXPLORATION Efficient exploration is critical for reinforcement learning, particularly in sparse-reward tasks. In- trinsic motivation ( Oudeyer & Kaplan, 2009 ) is a crucial mechanism for behaviour learning since it provides the driver of exploration. Therefore, to trade off exploration and exploitation, it is com- mon for an RL agent to maximize an objective of the expected extrinsic reward augmented by the expected intrinsic reward. Curiosity is one of the extensively-studied intrinsic rewards to encourage an agent to explore according to its uncertainty about the environment, which can be measured by model prediction error ( Burda et al., 2019 ;  Pathak et al., 2017 ;  Burda et al., 2018 ) or state visitation count ( Bellemare et al., 2016 ;  Tang et al., 2017 ;  Ostrovski et al., 2017 ). While such an intrinsic motivation as curiosity drives effective individual exploration, it is often not sufficient enough for learning in collaborative multi-agent settings, because it does not take Published as a conference paper at ICLR 2020 into account agent interactions. To encourage interactions, we propose an influence value aims to quantify one agent's influence on the exploration processes of other agents. Maximizing this value will encourage agents to visit interaction points more often through which the agent team can reach configurations that are rarely visited by decentralized exploration. In next sections, we will provide two ways to formulate the influence value with such properties, leading to two exploration strategies. Thus, for each agent i, our overall optimization objective is: J θi [π i |π −i , p 0 ] ≡ V ext,π (s 0 ) + V int,π i (s 0 ) + β · I π −i|i , (1) where p 0 (s 0 ) is the initial state distribution, π −i is the joint policy excluding that of agent i, and V int,π i (s) is the intrinsic value function of agent i, I π −i|i is the influence value, β > 0 is a weighting term. In this paper, we use the following notations: where u i (s i , a i ) is a curiosity-derived intrinsic reward,r i (s, a) is a sum of intrinsic and extrinsic rewards, V π i (s) and Q π i (s, a) here contain both intrinsic and extrinsic rewards.

Section Title: EXPLORATION VIA INFORMATION-THEORETIC INFLUENCE
  EXPLORATION VIA INFORMATION-THEORETIC INFLUENCE One critical problem in our learning framework presented above is to define the influence value I. For simplicity, we start with a two-agent case. The first method we propose is to use mutual information between agents' trajectories to measure one agent's influence on other agents' learning processes. Such mutual information can be defined as information gain of one agent's state transition given the other's state and action. Without loss of generality, we define it from the perspective of agent 1: where s = (s 1 , s 2 ) is the joint state, a = (a 1 , a 2 ) is the joint action, and S i and A i are the random variables of state and action of agent i subject to the distribution induced by the joint policy π. So we define I π 2|1 as M I π 2|1 (S 2 ; S 1 , A 1 |S 2 , A 2 ) that captures transition interactions between agents. Optimizing this objective encourages agent 1 to visited critical points where it can influence the transition probability of agent 2. We call such an exploration method exploration via information- theoretic influence (EITI). Optimizing M I π 2|1 with respect to the policy parameters θ 1 of agent 1 is a little bit challenging, because it is an expectation with respect to a distribution that depends on θ 1 . The gradient consists of two terms: While the second term is an expectation over the trajectory and can be shown to be zero (see Ap- pendix B.1), it is unwieldy to deal with the first term because it requires the gradient of the stationary distribution, which depends on the policies and the dynamics of the environment. Fortunately, the gradient can still be estimated purely from sampled trajectories by drawing inspiration from the proof of the policy gradient theorem ( Sutton et al., 2000 ). The resulting policy gradient update is: Published as a conference paper at ICLR 2020 whereV π 1 (s t ) is an augmented value function ofR t The third term, which we call EITI reward, is 0 when the agents are transition-independent, i.e., when p(s t+1 2 |s t 1 , s t 2 , a t 1 , a t 2 ) = p(s t+1 2 |s t 2 , a t 2 ), and is positive when s t 1 , a t 1 increase the probability of agent 2 translating to s t+1 2 . Therefore, the EITI reward is an intrinsic motivation that encourages agent 1 to visit more frequently the state-action pairs where it can influence the trajectory of agent 2. The estimation of p(s t+1 2 |s t 1 , s t 2 , a t 1 , a t 2 ) and p(s t+1 2 |s t 2 , a t 2 ) are discussed in Appendix C. We assume that agents know the states and actions of other agents, but this information is only available during centralized training. When execution, agents only have access to their local observations.

Section Title: EXPLORATION VIA DECISION-THEORETIC INFLUENCE
  EXPLORATION VIA DECISION-THEORETIC INFLUENCE Mutual information characterizes the influence of one agent's trajectory on that of the other and captures interactions between the transition functions of the agents. However, it does not provide the value of these interactions to identify interactions related to more internal and external rewards (r). To address this issue, we propose exploration via decision-theoretic influence (EDTI) based on a decision-theoretic measure of I, called Value of Interaction (VoI), which disentangles both transition and reward influences. VoI is defined as the expected difference between the action-value function of one agent (e.g., agent 2) and its counterfactual action-value function without considering the state and action of the other agent (e.g., agent 1): V oI π 2|1 (S 2 ; S 1 , A 1 |S 2 , A 2 ) = s,a,s 2 ∈(S,A,S2) p π (s, a, s 2 ) Q π 2 (s, a, s 2 ) − Q π,* 2|1 (s 2 , a 2 , s 2 ) , (9) where Q π 2 (s, a, s 2 ) is the expected rewards (including intrinsic rewards) of agent 2 defined as: and the counterfactual action-value function Q π,* 2 (also includes intrinsic and extrinsic rewards) can be obtained by marginalizing out the state and action of agent 1: Note that the definition of VoI is analogous to that of MI and the difference lies in that log p(·) measures the amount of information while Q measures the action value. Although VoI can be ob- tained by learning Q π 2 (s, a) and Q π 2 (s 2 , a 2 ) and calculating the difference, we propose to explicitly marginalize out s * 1 and a * 1 utilizing the estimated model transition probability p π (s 2 |s 2 , a 2 ) and p(s 2 |s, a) to get a more accurate value estimate ( Feinberg et al., 2018 ). The performance of these two formulations are compared in the experiments. Value functions Q and V used in VoI contains both expected external rewards and internal rewards, which will not only encourage coordinated exploration by the influence between intrinsic rewards but also filter out meaningless interactions which can not lead to extrinsic reward after intrinsic reward diminishes. To facilitate the optimization of VoI, we rewrite it as an expectation over state- action trajectories. wherer π 2 (s 2 , a 2 ) is the counterfactual immediate reward. The detailed proof is deferred to Appendix B.2. From this definition, we can intuitively see how VoI reflects the value of interactions.r 2 (s, a)− r π 2 (s 2 , a 2 ) and 1 − p π (s 2 |s 2 , a 2 )/p(s 2 |s, a) measure the influence of agent 1 on the immediate reward and the transition function of agent 2, and V π 2 (s ) serves as a scale factor in terms of future value. Only when agent 1 and agent 2 are both transition- and reward-independent, i.e., when p π (s 2 |s 2 , a 2 ) = p(s 2 |s, a) and r π 2 (s 2 , a 2 ) = r 2 (s, a) will VoI equal to 0. In particular, maximizing Published as a conference paper at ICLR 2020 VoI with respect to policy parameters θ 1 will lead agent 1 to meaningful interaction points, where V π 2 (s ) is high and s 1 , a 1 can increase the probability that s is reached. In this learning framework, agents initially explore the environment individually driven by its own curiosity, during which process they will discover potentially valuable interaction points where they can influence the transition function and (intrinsic) rewarding structure of each other. VoI highlights these points and encourages agents to visit these configurations more frequently. As intrinsic re- ward diminishes, VoI can gradually distinguish those interaction points which are necessary to get extrinsic rewards.

Section Title: POLICY OPTIMIZATION WITH VOI
  POLICY OPTIMIZATION WITH VOI We want to optimize J θi with respect to the policy parameters θ i , where the most cumbrous term is ∇ θi V oI −i|i . For brevity, we can consider a two-agent case, e.g., optimizing V oI 2|1 with respect to the policy parameters θ 1 . Directly computing the gradient ∇ θ1 V oI 2|1 is not stable, because V oI 2|1 contains policy-dependent functionsr π 2 (s 2 , a 2 ), p π (s 2 |s 2 , a 2 ), and V π 2 (s ) (see Eq. 12). To stabilize training , we use target functions to approximate these policy-dependent functions, which is a commonly used technique in deep RL ( Mnih et al., 2015 ). With this approximation, we denote where r − 2 , p − , and V − 2 are corresponding target functions. As these target functions are only period- ically updated during the learning, their gradients over θ 1 can be approximately ignored. Therefore, from Eq. 12, we have Similar to the calculation of ∇ θi M I, we get the gradient at every step (see Appendix B.3 for proof): whereV π 1 (s t ) is an augmented value function regressed towardsR t

Section Title: DISCUSSIONS
  DISCUSSIONS Scale to Large Settings: For cases with more than two agents, the VoI of agent i on other agents can be defined similarly to Eq. 9, which is annotated with V oI π −i|i (S −i ; S i , A i |S −i , A −i ), where S −i and A −i are the state and action sets of all agents other than agent i. In practice, agents in- teraction can often be decomposed to pairwise interaction so V oI π −i|i (S −i ; S i , A i |S −i , A −i ) is well approximated by the sum of values of pairwise value of interaction: Relationship between EITI and EDTI: EITI and EDTI gradient updates are obtained by information- and decision-theoretical influence respectively. Therefore, it is nontrivial to derive that part of the EDTI reward is a lower bound of the EITI reward:

Section Title: Comparing EDTI to Centralized Methods
  Comparing EDTI to Centralized Methods Different from a centralized method which directly includes value functions of other agents in the optimization objective, (i.e., by setting total reward r i = r + u i + β(u −i + γV −i ), which is called plusV henceforth), the EDTI reward for agent i disentangles its contributions to values of another agents using a counterfactual formulation. This difference is important for quantifying influence because the value of another agent does not just contain the contributions from agent i, but also those of itself and third-party agents. Therefore, EDTI is a kind of intrinsic reward assignment. Our experiments in the next section will compare the performance of plusV against our methods, which verify the importance of the intrinsic reward assignment.

Section Title: EXPERIMENTAL RESULTS
  EXPERIMENTAL RESULTS Our experiments aim to answer the following questions: (1) Can EITI and EDTI rewards capture interaction points? If they can, how do these points change throughout exploration? (2) Can exploit- ing these interaction points facilitate exploration and learning performance? (3) Can EDTI filter out interaction points that are not related to environmental rewards? (4) What if only reward influence between agents are disentangled? We evaluate our approach on a set of multi-agent tasks with sparse rewards based on a discrete version of multi-agent particle world environment ( Lowe et al., 2017 ). PPO ( Schulman et al., 2017 ) is used as the underlying algorithm. For evaluation, all experiments are carried out with 5 different random seeds and results are shown with 95% confidence interval. Demonstrative videos 1 are available online.

Section Title: Baselines
  Baselines We compare our methods with various baselines shown in  Table 1 . In particular, we carry out the following ablation studies: i) r influence disentangles immediate reward influence between agents, (derivation of the associated augmented reward can be found in Appendix B.4. Reward influ- ence in long term is not considered because it inevitably involves transition interactions) ii) PlusV as described in Sec. 3.3. iii) Shared critic uses decentralized PPO agents with shared centralized value function and thus is a cooperative version of MADDPG ( Lowe et al., 2017 ) augmented with intrin- sic reward of curiosity. iv) Q-Q is similar to EDTI but without explicit counterfactual formulation, as described in Sec. 3.2. We also note that EITI is an ablation of EDTI which considers transition interactions. PlusV, shared critic, Q-Q, and cen control have access to global or other agents' value functions during training. When execution, all the methods except cen control only require local state.

Section Title: DIDACTIC EXAMPLES
  DIDACTIC EXAMPLES We present two didactic examples of multi-agent cooperation tasks with sparse reward to explain how EITI and EDTI work. The first didactic example consists of a 30 × 30 maze with two rooms and a door with two switches ( Fig. 1  left). In the optimal strategy, one agent should first step on switch 1 to help the other agent pass the door, and then the agent that has already reached the right half should further go to switch 2 to bring the remaining agent in. There are two pairs of interaction points in this task: (switch 1, door) and (switch 2, door), i.e., transition probability of the agent near door is determined by whether another agent is on one of the switch. Fig. 1-right and  Fig. 2 -top show the learning curves of our methods and all the baselines, among which EITI, EDTI, r influence, Multi, and centralized control can learn the winning strategy and ours learn much more efficiently.  Fig. 2 -bottom gives a possible explanation why our methods work. EITI and EDTI rewards successfully highlight the interaction points (before 100 and 2100 updates, respectively). Agents are encouraged to explore these configurations more frequently and thus have better chance to learn the goal strategy. EDTI reward considers the value function of the other agent, so it converges slower than the EITI reward. In contrast, directly adding the other agent's intrinsic rewards and value functions is noisy (see "plusV reward") and confuses the agent because these contain the effect of the other agent's exploration. As for centralized control, global curiosity encourages agents to try all possible configurations, so it can find environmental rewards in most tasks. However, visiting all configurations without bias renders it inefficient - external rewards begin to dominate the behaviors of agents after 7000 updates even with the help of centralized learning algorithm. Our methods use the same information as centralized exploration but take advantages of agents' interactions to accelerate exploration. In order to evaluate whether EDTI can help filter out noisy interaction points and accelerate explo- ration, we conduct experiments in a second didactic task (see  Fig. 1  middle). It is also a navigation task in a 25 × 25 maze where agents are rewarded for being in a goal room. However, in this exper- iment, we consider a case where there are four rooms and the upper right one is attached to reward. This task contains 6 pairs of interaction points (switch 1 with each of the doors, each switch with the door of the same room), but only two of them are related to external rewards, i.e., (switch 1, door 1) and (switch 2, door 1). As  Fig. 3 -right shows, EITI agents treat three doors equally even after 7400 updates (see  Fig. 3  right, 7400 updates, top row). In comparison, although EDTI reward suffers from noise in the beginning, it clearly highlight two pairs of valuable interaction points (see  Fig. 3  right, 7400 updates, bottom row) as intrinsic reward diminishes. This can explain why EDTI outperforms EITI ( Fig. 3  left).

Section Title: EXPLORATION IN COMPLEX TASKS
  EXPLORATION IN COMPLEX TASKS Next, we evaluate the performance of our methods on more complex tasks. To this end, we use three sparse reward cooperative multi-agent tasks depicted in Fig. 7 of Appendix D and analyzed below. Details of implementation and experiment settings are also described in Appendix D. Push-Box: A 15 × 15 room is populated with 2 agents and 1 box. Agents need to push the box to the wall in 300 environment steps to get a reward of 1000. However, the box is so heavy that only when two agents push it in the same direction at the same time can it be moved a grid. Agents need to coordinate their positions and actions for multiple steps to earn a reward. The purpose of this task is to demonstrate that EITI and EDTI can explore long-term cooperative strategy.

Section Title: Island
  Island This task is a modified version of the classic Stag Hunt game ( Peysakhovich & Lerer, 2018 ) where two agents roam a 10 × 10 island populated with 9 treasures and a random walking beast for 300 environment steps. Agents can collect a treasure by stepping on it to get a team reward of 10 or, by attacking the beast within their attack range, capture it for a reward of 300. The beast would also attack the agents when they are too close. The beast and agent have a maximum energy of 8 and 5 respectively, which will be subtracted by 1 every time attacked. Therefore, an agent is too weak to beat the beast alone and they have to cooperate. In order to learn optimal strategy in this task, one method has to keep exploring after sub-optimal external rewards are found.

Section Title: Large-Island
  Large-Island Similar to Island but with more agents (4), more treasures (16), and a beast with more energy (16) and a higher reward (600) for being caught. This task aims to demonstrate feasibility of our methods in cases with more than 2 agents. Push-Box requires agents to take coordinated actions at certain positions for multiple steps to get rewarded. Therefore, this task is particularly challenging and all the baselines struggle to earn any reward ( Fig. 4  left and Fig. 8 left). Our methods are considerably more successful because interaction happens when the box is moved - agents remain unmoved when they push the box alone but will move by a grid if push it together. In this way, EITI and EDTI agents are rewarded intrinsically to move the box and thus are able to quickly find the optimal policy. In the Island task, collecting treasures is a easily-attainable local optimal. However, efficient trea- sures collecting requires the agents to spread on the island. This leads to a situation where attempting to attack the beast seems a bad choice since it is highly possible that agents will be exposed to the beast's attack alone. They have to give up profitable spreading strategy and take the risk of being killed to discover that if they attack the beast collectively for several timesteps, they will get much more rewards. Our methods help solve this challenge by giving agents intrinsic incentives to appear together in the attack range of the beast, where they have indirect interactions (health is part of the state and it decreases slower when the two are attacked alternatively). Fig. 9 in Appendix D demon- strates that our methods learn to catch the beast quickly, and thus have better performance (Fig. 8 right). Finally, outperformance of our methods on Large-Island proves that they can successfully handle cases with more than two agents. In summary, both of our methods are able to facilitate effective exploration on all the tasks by exploiting interactions. EITI outperforms EDTI in scenarios where all interaction points align with extrinsic rewards. On other tasks, EDTI performs better than EITI due to its ability to filter out interaction points that can not lead to more values. We also study EDTI with only intrinsic rewards, discussion and results are included in Appendix A.

Section Title: RELATED WORKS
  RELATED WORKS Single-agent exploration achieves conspicuous success recently. Provably efficient methods are pro- posed, such as upper confidence bound (UCB) ( Jaksch et al., 2010 ;  Azar et al., 2017 ;  Jin et al., 2018 ) and posterior sampling for reinforcement learning (PSRL) ( Strens, 2000 ;  Osband et al., 2013 ;  Osband & Van Roy, 2016 ;  Agrawal & Jia, 2017 ). Given that these methods do not scale well to large or continuous settings, another line of research has been focusing on curiosity-driven explo- ration ( Schmidhuber, 1991 ;  Chentanez et al., 2005 ;  Oudeyer et al., 2007 ;  Barto, 2013 ;  Bellemare et al., 2016 ;  Pathak et al., 2017 ;  Ostrovski et al., 2017 ), and have shown impressive results ( Burda et al., 2019 ; 2018;  Hyoungseok Kim, 2019 ). In addition, methods based on variational informa- tion maximization ( Houthooft et al., 2016 ;  Barron et al., 2018 ) and mutual information ( Rubin et al., 2012 ;  Still & Precup, 2012 ;  Salge et al., 2014 ;  Mohamed & Rezende, 2015 ;  Hyoungseok Kim, 2019 ) have been proposed for single-agent intrinsically motivated exploration. Although multi-agent reinforcement learning (MARL) has been making significant progresses in recent years ( Foerster et al., 2018 ;  Lowe et al., 2017 ;  Wen et al., 2019 ;  Iqbal & Sha, 2019a ;  Sune- hag et al., 2018 ;  Son et al., 2019 ;  Rashid et al., 2018 ), less attention has been drawn to multi-agent exploration.  Dimakopoulou & Van Roy (2018)  and  Dimakopoulou et al. (2018)  propose poste- rior sampling methods for exploration of concurrent reinforcement learning in coverage problems,  Bargiacchi et al. (2018)  presents a multi-agent upper confidence exploration method for repeated single-stage problems, and  Iqbal & Sha (2019b)  investigates methods to combine several decentral- ized curiosity-driven exploration strategies. All these works focus on transition-independent set- tings. Another Bayesian exploration approach has been proposed for learning in stateless repeated games ( Chalkiadakis & Boutilier, 2003 ). In contrast, this paper focuses on more general multi-agent sequential decision making problems with complex reward dependencies and transition interactions among agents. In the literature of MARL, COMA ( Foerster et al., 2018 ) shares some similarity with our decision- theoretic EDTI approach in that both of them use the idea of counterfactual formulations. However, they are quite different in terms of definition and optimization: (1) conceptually, EDTI measures the influence of one agent on the value functions of other agents, while COMA quantifies individual contribution to the team value; (2) EDTI is defined on counterfactual Q-value over state-action pairs of other agents given its own state-action pair, while COMA uses the counterfactual Q-value just over its own action without considering state information, which is critical for exploration; (3) we explicitly derive the gradients for optimizing EDTI influence for coordinated exploration in the policy gradient framework, which provides more accurate feedback, while COMA uses the counterfactual Q value as a critic. Another line of relevant works ( Oliehoek et al., 2012 ;  de Castro et al., 2019 ) propose influence-based abstraction to predict influence sources to help local decision making of agents. In contrast, this paper presents two novel approaches that quantify and maximize the influence between agents for enabling coordinated multi-agent exploration. In addition, some previous MARL work has also studied intrinsic rewards. One notably relevant work is  Jaques et al. (2018) , which models the social influence of one agent on other agents' policies. In contrast, EITI measures the influence of one agent on the transition dynamics of other agents. Accompanying this distinction, EITI includes states of agents in the calculation of influence while social influence dos not. Apart from that, the optimization methods are also different - we directly derive the gradients of mutual information and incorporate its optimization in the policy gradient framework, while  Jaques et al. (2018)  adds social influence reward to the immediate environmental reward for training policies.  Hughes et al. (2018)  proposes an inequality aversion reward for learning in intertemporal social dilemmas.  Strouse et al. (2018)  uses mutual information between goal and states or actions as an intrinsic reward to train the agent to share or hide their intentions.

Section Title: CLOSING REMARKS
  CLOSING REMARKS In this paper, we study the multi-agent exploration problem and propose two influence-based meth- ods that exploits the interaction structure. These methods are based on two interaction measures, MI and Value of Interaction (VoI), which respectively measure the amount and value of one agent's influence on the other agents' exploration processes. These two measures can be best regraded as exploration bonus distribution. We also propose an optimization method in the policy gradient framework, which enables agents to achieve coordinated exploration in a decentralized manner and optimize team performance.

```
